<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Manual Drag and Drop</title>
    <style>
      #draggable {
        width: 100px;
        height: 100px;
        background-color: red;
        position: absolute;
        cursor: grab;
        touch-action: none; /* Prevent default touch actions like scrolling */
      }
    </style>
  </head>
  <body>
    <div id="draggable"></div>

    <script>
      const draggable = document.getElementById("draggable");
      let isDragging = false;
      let startX, startY, initialX, initialY;

      // Helper function to handle the start of the drag
      function startDrag(event) {
        isDragging = true;
        // Differentiate between mouse and touch events
        if (event.type === "mousedown") {
          startX = event.clientX;
          startY = event.clientY;
        } else if (event.type === "touchstart") {
          startX = event.touches[0].clientX;
          startY = event.touches[0].clientY;
        }
        initialX = draggable.offsetLeft;
        initialY = draggable.offsetTop;

        // Change the cursor style to indicate dragging
        draggable.style.cursor = "grabbing";
      }

      // Helper function to handle the dragging movement
      function drag(event) {
        if (isDragging) {
          let currentX, currentY;
          if (event.type === "mousemove") {
            currentX = event.clientX;
            currentY = event.clientY;
          } else if (event.type === "touchmove") {
            currentX = event.touches[0].clientX;
            currentY = event.touches[0].clientY;
          }

          const dx = currentX - startX;
          const dy = currentY - startY;

          draggable.style.left = initialX + dx + "px";
          draggable.style.top = initialY + dy + "px";
        }
      }

      // Helper function to handle the end of the drag
      function endDrag() {
        isDragging = false;
        draggable.style.cursor = "grab";
      }

      // Add event listeners
      draggable.addEventListener("mousedown", startDrag);
      draggable.addEventListener("mousemove", drag);
      draggable.addEventListener("mouseup", endDrag);
      draggable.addEventListener("mouseleave", endDrag); // To handle the case where mouse leaves the element

      // Add touch event listeners
      draggable.addEventListener("touchstart", startDrag);
      draggable.addEventListener("touchmove", drag);
      draggable.addEventListener("touchend", endDrag);
    </script>
  </body>
</html>
